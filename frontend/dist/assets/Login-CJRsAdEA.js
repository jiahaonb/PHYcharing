import{_ as y}from"./_plugin-vue_export-helper-BCEt7Ct6.js";/* empty css                     *//* empty css                  *//* empty css                 */import{u as k,r as g,a as V,c as x,o as E,b as r,d as o,w as l,e as F,E as B,f as L,g as R,h as z,i as A,j as C,k as I,l as _,m as f}from"./index-DURBC1W6.js";const N={class:"login-container"},S={class:"login-card"},U={class:"login-footer"},q={__name:"Login",setup(K){const m=L(),a=k(),t=g(),n=g(!1),s=V({username:"",password:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},i=async()=>{t.value&&await t.value.validate(async p=>{if(p){n.value=!0;try{await a.login(s),f.success("登录成功"),console.log("登录成功，准备跳转"),console.log("用户信息:",a.user),console.log("是否管理员:",a.isAdmin),a.isAdmin?(console.log("管理员跳转到 /admin/dashboard"),await m.push("/admin/dashboard")):(console.log("普通用户跳转到 /user/dashboard"),await m.push("/user/dashboard"))}catch(e){console.error("登录失败:",e),f.error("登录失败: "+e.message)}finally{n.value=!1}}})};return(p,e)=>{const c=A,u=z,v=I,b=R("router-link"),h=B;return E(),x("div",N,[r("div",S,[e[5]||(e[5]=r("div",{class:"login-header"},[r("h1",null,"智能充电桩调度计费系统"),r("p",null,"用户登录")],-1)),o(h,{ref_key:"loginFormRef",ref:t,model:s,rules:w,class:"login-form",onSubmit:F(i,["prevent"])},{default:l(()=>[o(u,{prop:"username"},{default:l(()=>[o(c,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=d=>s.username=d),placeholder:"请输入用户名",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),o(u,{prop:"password"},{default:l(()=>[o(c,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=d=>s.password=d),type:"password",placeholder:"请输入密码",size:"large","prefix-icon":"Lock","show-password":"",onKeyup:C(i,["enter"])},null,8,["modelValue"])]),_:1}),o(u,null,{default:l(()=>[o(v,{type:"primary",size:"large",loading:n.value,class:"login-button",onClick:i},{default:l(()=>e[2]||(e[2]=[_(" 登录 ")])),_:1,__:[2]},8,["loading"])]),_:1}),r("div",U,[e[4]||(e[4]=r("span",null,"还没有账号？",-1)),o(b,{to:"/register",class:"register-link"},{default:l(()=>e[3]||(e[3]=[_(" 立即注册 ")])),_:1,__:[3]})])]),_:1},8,["model"])])])}}},H=y(q,[["__scopeId","data-v-480e4c18"]]);export{H as default};
